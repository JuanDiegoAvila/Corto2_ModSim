<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>corto_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="corto_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="corto_2_files/libs/quarto-html/quarto.js"></script>
<script src="corto_2_files/libs/quarto-html/popper.min.js"></script>
<script src="corto_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="corto_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="corto_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="corto_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="corto_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="corto_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="corto_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="corto-1" class="level1">
<h1>Corto 1</h1>
<p>Juan Diego Avila 20090</p>
<section id="parte-1---preguntas-teoricas" class="level2">
<h2 class="anchored" data-anchor-id="parte-1---preguntas-teoricas">Parte 1 - Preguntas Teoricas</h2>
<ol type="1">
<li><strong>Defina los componentes de las Cadenas de Markov</strong>
<ul>
<li><em>Estados</em>:
<ul>
<li>Son las posibles situaciones o las condiciones en las que se puede encontrar el sistema en un momento dado. Cada uno de los estados es un caso particular de la situación del sistema.</li>
</ul></li>
<li><em>Probabilidades de transición</em>:
<ul>
<li>Es la probabilidad de pasar de un estado a otro en un solo paso.</li>
</ul></li>
<li><em>Probabilidades de estado inicial</em>:
<ul>
<li>Es el conjunto de probabilidades de que el sistema se encuentre en cada uno de los estados en el momento inicial. Son las condiciones iniciales del sistema en forma de una distribución.</li>
</ul></li>
</ul></li>
<li>Defina por lo menos 3 propiedades de las Cadenas de Markov
<ul>
<li><em>Homogeneidad temporal</em>:
<ul>
<li>Esto significa que la probabilidad de transición entre estados no cambia con el tiempo.</li>
</ul></li>
<li><em>Falta de memoria</em>:
<ul>
<li>Esto significa que la probabilidad de transición entre estados no depende de los estados anteriores y su probabilidad. Esta transición solo depende del estado actual.</li>
</ul></li>
<li><em>Estados Absorbentes</em>:
<ul>
<li>Son los estados a los que se puede llegar pero no se puede salir de ellos. No pueden hacer transición a otro estado. La probabilidad de transición a un estado absorbente es 1.</li>
</ul></li>
</ul></li>
<li>¿Por qué se suele usar procesos de Poisson para simular colas?
<ul>
<li>Porque la distribución de Poisson permite modelar la llegada de eventos aleatoriamente en una tasa constante.</li>
</ul></li>
<li>Defina las dos etapas que se suelen emplear para Simulation Optimization
<ul>
<li><em>Primera-etapa</em>:
<ul>
<li>Se busca encontrar las mejores decisiones para un conjunto de parámetros fijos, es decir información conocida previamente. Estas decisiones se llaman decisiones aquí-y-ahora.</li>
</ul></li>
<li><em>Segunda-etapa</em>:
<ul>
<li>Se busca en tomar las decisiones basadas en aleatoriedad según la información que se obtuvo en la primera etapa. Estas decisiones se llaman decisiones de recurso.</li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="parte-2---pregunta-práctica" class="level2">
<h2 class="anchored" data-anchor-id="parte-2---pregunta-práctica">Parte 2 - Pregunta Práctica</h2>
<p>Usted tiene la tarea de evaluar una oportunidad de inversión en un determinado horizonte de inversión. La inversión involucra factores inciertos, como, la tasa de interés y la volatilidad de los rendimientos. Desea analizar cómo las variaciones en estos factores influyen en el valor actual neto (VAN) de la inversión. * Número de simulaciones: 1000 * Horizonte de Inversión: 5 años * Tasa de descuento: 0,1 (utilizado para calcular los flujos de efectivo descontados) * Variables del problema: * Tasa de Interés: Rangos de 0.08 a 0.12 * Volatilidad: Rangos de 0.15 a 0.25</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> SALib.sample <span class="im">import</span> saltelli</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> SALib.analyze <span class="im">import</span> sobol</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generar flujos de caja aleatorios: Simule flujos de caja de inversión para cada escenario utilizando una distribución normal aleatoria con una media de 500000 y una desviación estándar de 100000. Descuente los flujos de caja a sus valores actuales utilizando la tasa de descuento.</p>
<p>Análisis de Sensibilidad: Realice un análisis de sensibilidad global utilizando índices Sobol para determinar el impacto de las variaciones en la tasa de interés y la volatilidad en el VAN de la inversión. Puede usar librerías como SALib etc.</p>
<p>Visualización: visualice los índices de sensibilidad de Sobol para comprender la importancia relativa de cada variable de entrada para influir en el VPN (Valor Presente Neto).</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>numero_simulaciones <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>horizonte_inversion <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tasa_descuento <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>media <span class="op">=</span> <span class="dv">500000</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>desviacion_estandar <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>problem <span class="op">=</span> {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'num_vars'</span>: <span class="dv">2</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'names'</span>: [<span class="st">'tasa_de_interes'</span>, <span class="st">'volatilidad'</span>],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bounds'</span>: [[<span class="fl">0.08</span>, <span class="fl">0.12</span>], [<span class="fl">0.15</span>, <span class="fl">0.25</span>]]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>param_values <span class="op">=</span> saltelli.sample(problem, numero_simulaciones, calc_second_order<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>cashflows_matrix <span class="op">=</span> np.random.normal(media, desviacion_estandar, (param_values.shape[<span class="dv">0</span>], horizonte_inversion))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>discount_factors <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> tasa_descuento) <span class="op">**</span> np.arange(<span class="dv">1</span>, horizonte_inversion <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>discounted_cashflows <span class="op">=</span> cashflows_matrix <span class="op">*</span> discount_factors</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>npv_matrix <span class="op">=</span> discounted_cashflows.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula los índices de Sobol de primer y segundo orden</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>sobol_indices <span class="op">=</span> sobol.analyze(problem, npv_matrix, calc_second_order<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sobol Indices (first order):"</span>, sobol_indices[<span class="st">'S1'</span>])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sobol Indices (total order):"</span>, sobol_indices[<span class="st">'ST'</span>])</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtén los índices de primer y total orden de sensibilidad</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>s1_indices <span class="op">=</span> sobol_indices[<span class="st">'S1'</span>]</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>st_indices <span class="op">=</span> sobol_indices[<span class="st">'ST'</span>]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de las variables de entrada</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>variable_names <span class="op">=</span> problem[<span class="st">'names'</span>]</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una figura y ejes</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar los índices de sensibilidad</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>ax.bar(variable_names, s1_indices, label<span class="op">=</span><span class="st">'S1 (First Order)'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>ax.bar(variable_names, st_indices, label<span class="op">=</span><span class="st">'ST (Total Order)'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar etiquetas y leyendas</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Variables de Entrada'</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Índices de Sensibilidad'</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Índices de Sensibilidad de Sobol'</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Juan_Avila\AppData\Local\Temp\ipykernel_14008\3534029810.py:15: DeprecationWarning: `salib.sample.saltelli` will be removed in SALib 1.5. Please use `salib.sample.sobol`
  param_values = saltelli.sample(problem, numero_simulaciones, calc_second_order=False)
c:\Users\Juan_Avila\AppData\Local\Programs\Python\Python310\lib\site-packages\SALib\sample\saltelli.py:109: UserWarning: 
        Convergence properties of the Sobol' sequence is only valid if
        `N` (1000) is equal to `2^n`.
        
  warnings.warn(msg)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sobol Indices (first order): [ 0.07851498 -0.03506391]
Sobol Indices (total order): [1.00485125 1.02827398]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="corto_2_files/figure-html/cell-3-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>Se utilizo chat-gpt y el orden de prompts fue:</p>
<ul>
<li>Tengo los siguientes parametros con los que deseo hacer un analisis de sensibilidad global ”
<ul>
<li>Número de simulaciones: 1000</li>
<li>Horizonte de Inversión: 5 años</li>
<li>Tasa de descuento: 0,1 (utilizado para calcular los flujos de efectivo descontados)</li>
<li>Variables del problema:</li>
<li>Tasa de Interés: Rangos de 0.08 a 0.12</li>
<li>Volatilidad: Rangos de 0.15 a 0.25” Necesito simular flujos de caja de inversion para cada escenario usando la distribucion normal con media de 500000 y una desviacion estandar de 100000. Necesito descontar los flujos de caja a sus valores actuales usando la tasa de descuento en python</li>
</ul></li>
<li>Teniendo eso necesito hacer un analisis de sensibilidad global usando indices de sobol para determinar el impacto de las variaciones en la tasa de interes y la volatilidad en VAN de la inversion utilizando la libreria SALib</li>
<li>Hubo un error con los parametros normalizados por lo que se tuvo que hacer un cambio en el codigo para que funcionara.</li>
<li>Con los resultados de lo que me proporcionaste visualice los índices de sensibilidad de Sobol para comprender la importancia relativa de cada variable de entrada para influir en el VPN (Valor Presente Neto).</li>
</ul>
<section id="preguntas" class="level3">
<h3 class="anchored" data-anchor-id="preguntas">Preguntas</h3>
<ol type="1">
<li>¿Qué tanto influye cada variable en el VPN?
<ul>
<li>Ambas variables influyen en el VPN. La tasa de interes tiene una influencia positiva en el VPN, mientras que la volatilidad tiene una influencia negativa en el VPN.</li>
</ul></li>
<li>¿Qué variable influye más? ¿Por qué cree que es esto?
<ul>
<li>La variable de tasa de interes tiene una influencia positiva en el VPN, por lo que puede ser una variable que influye mas en el VPN. Esto puede ser porque a mayor tasa de interes, mayor es el valor del VPN.</li>
</ul></li>
<li>¿Hay una diferencia significativa en la influencia de cada variable? ¿Por qué?
<ul>
<li>Si ya que como se puede observar, la tasa de interes tiene un S1 positivo mientras que la volatilidad tiene negativo. Esto puede indicar que la tasa de interes tiene mas influencia directa, pero a pesar de esto las dos variables si tienen bastante influencia en el VPN porque tienen un ST bastante parecido.</li>
</ul></li>
<li>Si tuviera que hacer mejoras al análisis ¿qué podría hacer? (Puede usar recursos de internet para esta parte, sí puede usar ChatGPT de nuevo acá)
<ul>
<li>Aumentar el numero de simulaciones para poder obtener resultados mas precisos.</li>
<li>Explorar las interacciones de segundo orden entre las variables para entender mejor las interacciones complejas entre las variables.</li>
<li>Se puede hacer un analisis de sensibilidad basado en metamodelos lo que ayudaría a reducir la cantidad de simulaciones necesarias para obtener resultados mas precisos.</li>
</ul></li>
</ol>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>